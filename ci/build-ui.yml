platform: linux

image_resource:
  type: docker-image
  source:
    repository: node
    tag: '18-alpine'

inputs:
  - name: source-git
outputs:
  - name: source-git
run:
  path: sh
  args:
    - -exc
    - |
      #!/bin/sh
      apk add --no-cache git
      cd source-git
      version=$(git describe --long | awk -F- '{printf "V%s-%04d-%s", $1, $2, $3}')_dev
      echo $version > ./ci/version.txt